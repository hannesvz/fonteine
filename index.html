<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Fonteine.</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet.heat@0.2.0/dist/leaflet-heat.js" crossorigin=""></script>
  <style>
  body {
    padding: 0;
    margin: 0;
  }
  html, body, #map {
    height: 100%;
    width: 100vw;
  }
  </style>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  </head>

  <body>
  <div id="map"></div>

  <script>

  const map = L.map('map').setView([-28,23], 6);
  const attribution = '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';
  const tileUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
  const tiles = L.tileLayer(tileUrl, { attribution });
  tiles.addTo(map);

  let markers = [];

  // data obtained from the dataset generated by Dirk Strauss https://dirkstrauss.com/south-african-cities/

  async function loadData() {
    const res1 = await fetch('./fonteine.json');
    const res2 = await res1.json();

    let heatpoints = [];

    res2.forEach(i => {
      let latLng = L.latLng([i.Latitude, i.Longitude]);
      let point = map.latLngToContainerPoint(latLng);
      let newPoint = L.point([point.x - 0, point.y - 0]);
      let newLatLng = map.containerPointToLatLng(newPoint);

      let marker = L.marker(newLatLng)
      .bindTooltip(i.AccentCity)
      .addTo(map);
      markers.push(marker);

      // add the heatmap points
      heatpoints.push([i.Latitude, i.Longitude, 100]);
    }); // finished iterating through list of points

    //let heat = L.heatLayer(heatpoints, {radius: 20}).addTo(map);

  }

  
/*
  var heat = L.heatLayer([
	[50.5, 30.5, 0.2], // lat, lng, intensity
	[50.6, 30.4, 0.5]
  ], {radius: 25}).addTo(map);
*/

  window.addEventListener("load", loadData, false);

  </script>

  </body>
</html>
